@model ZEN.SaleAndTranfer.VM.RPT.StockVM

@{
    ViewBag.Title = "StatusReceiveByDoAndGr";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@Html.Partial("_MessagePartial", Model.MessageList)

@Html.HiddenFor(m => m.stockVM_MA.REPORT_DATA)


<div class="container">
    <h2>รายงานสถานะการทำรับสินค้าเปรียบเทียบระหว่าง DO และ GR</h2>
    <hr />
    <form class="form-horizontal" id="form1">
        <div class="panel panel-primary">
            <div class="panel-heading">ระบุเงื่อนไขการค้นหา</div>
            <div class="panel-body">
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="col-md-2 control-label">*บริษัท:</label>
                        <div class="col-md-4">
                            @if (Model.statusDoGrSearchCriteriaVM != null)
                            {
                                if (Model.statusDoGrSearchCriteriaVM.brandList != null)
                                {
                            @Html.DropDownListFor(m => m.statusDoGrSearchCriteriaVM.BRAND_CODE,
                                    new SelectList(@Model.statusDoGrSearchCriteriaVM.brandList, "ITEM_VALUE", "ITEM_TEXT")
                                    , new
                                    {
                                        @class = "form-control"
                                    })
                                }
                            }
                        </div>
                        <label class="col-sm-2 control-label">*สาขา:</label>
                        <div class="col-md-4">
                            @if (Model.statusDoGrSearchCriteriaVM != null)
                            {
                                if (Model.statusDoGrSearchCriteriaVM.branchList != null)
                                {
                            @Html.DropDownListFor(m => m.statusDoGrSearchCriteriaVM.BRANCH_CODE,
                                    new SelectList(@Model.statusDoGrSearchCriteriaVM.branchList, "ITEM_VALUE", "ITEM_TEXT")
                                    , new
                                    {
                                        @class = "form-control"
                                    })
                                }
                            }
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label">*ตั้งแต่</label>
                        <div class="col-md-4">
                            @Html.TextBoxFor(m => m.statusDoGrSearchCriteriaVM.DATE_FROM, Model.DT_SHORT_FORMAT,
                            new
                            {
                                @class = "form-control datepicker",
                                @onkeypress = "return false;"
                            })
                        </div>
                        <label class="col-md-2 control-label">*ถึง</label>
                        <div class="col-md-4">
                            @Html.TextBoxFor(m => m.statusDoGrSearchCriteriaVM.DATE_TO, Model.DT_SHORT_FORMAT,
                            new
                            {
                                @class = "form-control datepicker",
                                @onkeypress = "return false;"
                            })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3"></div>
                        <div class="col-md-4">
                            <input type="button" class="btn btn-primary" value="ค้นหา" onclick="gotoSearch();" />
                            &nbsp;&nbsp;
                            <input type="button" class="btn btn-default" value="ล้างหน้าจอ" onclick="gotoClear();" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @if (Model.statusDoGrSearchResultVM != null)
        {
            if (Model.statusDoGrSearchResultVM.resultList != null)
            {
                if (Model.statusDoGrSearchResultVM.resultList.Count > 0)
                {
                    int countAll = Model.statusDoGrSearchResultVM.resultList.Count - 1;
                    <div class="form-group">
                        <div class="col-sm-12" style="text-align:right;">
                            <input type="button" class="btn btn-success" value="ออกรายงาน" onclick="gotoDownloadFile();" />
                        </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">
                            ผลการค้นหา
                            <span class="pull-right">ผลการค้นหา : @countAll.ToString("#,###") รายการ</span>
                        </div>
                        <div class="panel-body">
                            <div class="table table-responsive pre-scrollable">
                                <table class="table table-striped table-bordered table-hover table-condensed">
                                    @foreach (var item in Model.statusDoGrSearchResultVM.resultList)
                                    {
                                        if (item.ROW_NO == "ลำดับ")
                                        {
                                            <tr>
                                                <th class="text-nowrap">@item.ROW_NO</th>
                                                <th class="text-nowrap">@item.DO_DATE</th>
                                                <th class="text-nowrap">@item.CREATE_DATE_DO</th>
                                                <th class="text-nowrap">@item.BRAND_CODE</th>
                                                <th class="text-nowrap">@item.BRANCH_NAME</th>
                                                <th class="text-nowrap">@item.DO_CODE</th>
                                                <th class="text-nowrap">@item.GR_CODE</th>
                                                <th class="text-nowrap">@item.RECEIVE_BY</th>
                                                <th class="text-nowrap">@item.RECEIVE_DATE</th>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr>
                                                <td class="text-nowrap">@item.ROW_NO</td>
                                                <td class="text-nowrap">@item.DO_DATE</td>
                                                <td class="text-nowrap">@item.CREATE_DATE_DO</td>
                                                <td class="text-nowrap">@item.BRAND_CODE</td>
                                                <td class="text-nowrap">@item.BRANCH_NAME</td>
                                                <td class="text-nowrap">@item.DO_CODE</td>
                                                <td class="text-nowrap">@item.GR_CODE</td>
                                                <td class="text-nowrap">@item.RECEIVE_BY</td>
                                                <td class="text-nowrap">@item.RECEIVE_DATE</td>
                                            </tr>
                                        }
                                    }
                                </table>
                            </div>
                        </div>
                    </div>
                }
            }
        }
    </form>
</div>


<style>
    .text-nowrap {
        white-space: nowrap;
    }
</style>
<script>
    function gotoSearch() {
        var url1 = '@Url.Action("StatusReceiveByDoAndGrSearch")';
        url1 = url1.substring(0, url1.lastIndexOf("StatusReceiveByDoAndGrSearch")).concat("StatusReceiveByDoAndGrSearch");

        var vform = $('#form1');
        vform.attr("action", url1);
        vform.attr("method", "post");
        vform.submit();
    }

    function gotoClear() {
        var url1 = '@Url.Action("StatusReceiveByDoAndGr")';
        url1 = url1.substring(0, url1.lastIndexOf("StatusReceiveByDoAndGr")).concat("StatusReceiveByDoAndGr");

        var vform = $('#form1');
        vform.attr("action", url1);
        vform.attr("method", "post");
        vform.submit();
    }

    function gotoDownloadFile() {
        var url1 = '@Url.Action("StatusReceiveByDoAndGrExport")';
        url1 = url1.substring(0, url1.lastIndexOf("StatusReceiveByDoAndGrExport")).concat("StatusReceiveByDoAndGrExport");

        var vform = $('#form1');
        vform.attr("action", url1);
        vform.attr("method", "post");
        vform.submit();
    }
</script>