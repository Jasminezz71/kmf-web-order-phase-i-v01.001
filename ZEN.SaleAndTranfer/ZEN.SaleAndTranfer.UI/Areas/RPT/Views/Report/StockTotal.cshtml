@model ZEN.SaleAndTranfer.VM.RPT.StockVM

@{
    ViewBag.Title = "StockTotal";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@Html.Partial("_MessagePartial", Model.MessageList)

@Html.HiddenFor(m => m.stockVM_MA.REPORT_DATA)


<div class="container">
    <h2>รายงานการส่งและรับสินค้า</h2>
    <hr />
    <form class="form-horizontal" id="form1">
        <div class="panel panel-primary">
            <div class="panel-heading">ระบุเงื่อนไขการค้นหา</div>
            <div class="panel-body">
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="col-md-2 control-label">*บริษัท:</label>
                        <div class="col-md-4">
                            @if (Model.stockSearchCriteriaVM != null)
                            {
                                if (Model.stockSearchCriteriaVM.brandList != null)
                                {
                                    @Html.DropDownListFor(m => m.stockSearchCriteriaVM.BRAND_CODE,
                                    new SelectList(@Model.stockSearchCriteriaVM.brandList, "ITEM_VALUE", "ITEM_TEXT")
                                    , new
                                    {
                                        @class = "form-control"
                                    })
                                }
                            }
                        </div>
                        <label class="col-sm-2 control-label">*สาขา:</label>
                        <div class="col-md-4">
                            @if (Model.stockSearchCriteriaVM != null)
                            {
                                if (Model.stockSearchCriteriaVM.branchList != null)
                                {
                                    @Html.DropDownListFor(m => m.stockSearchCriteriaVM.BRANCH_CODE,
                                    new SelectList(@Model.stockSearchCriteriaVM.branchList, "ITEM_VALUE", "ITEM_TEXT")
                                    , new
                                    {
                                        @class = "form-control"
                                    })
                                }
                            }
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label">*ตรวจสอบสินค้า ณ เดือน :</label>
                        <div class="col-md-4">
                            @Html.TextBoxFor(m => m.stockSearchCriteriaVM.DATE_TO, "{0:MM/yyyy}",
                            new
                            {
                                @class = "form-control datepickerMonth",
                                @onkeypress = "return false;"
                            })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3"></div>
                        <div class="col-md-4">
                            <input type="button" class="btn btn-primary" value="ค้นหา" onclick="gotoSearch();" />
                            &nbsp;&nbsp;
                            <input type="button" class="btn btn-default" value="ล้างหน้าจอ" onclick="gotoClear();" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        @if (Model.stockSearchResultVM != null)
        {
            if (Model.stockSearchResultVM.resultList != null)
            {
                if (Model.stockSearchResultVM.resultList.Count > 0)
                {
                    int countAll = Model.stockSearchResultVM.resultList.Count - 1;
                    <div class="form-group">
                        <div class="col-sm-12" style="text-align:right;">
                            <input type="button" class="btn btn-success" value="ออกรายงาน" onclick="gotoDownloadFile();" />
                        </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">
                            ผลการค้นหา
                            @*<span class="pull-right">ผลการค้นหา : @countAll.ToString("#,###") รายการ</span>*@
                        </div>
                        <div class="panel-body">
                            <div class="table table-responsive pre-scrollable">
                                <table class="table table-striped table-bordered table-hover table-condensed">
                                    <tr>
                                        <th rowspan="2" class="text-nowrap" style="text-align: center; vertical-align: middle;">ประเภท</th>
                                        <th rowspan="2" class="text-nowrap" style="text-align: center; vertical-align: middle;">รหัสสินค้า</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">1</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">2</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">3</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">4</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">5</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">6</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">7</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">8</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">9</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">10</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">11</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">12</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">13</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">14</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">15</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">16</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">17</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">18</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">19</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">20</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">21</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">22</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">23</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">24</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">25</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">26</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">27</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">28</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">29</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">30</th>
                                        <th class="text-nowrap" style="text-align:center;" colspan="2">31</th>
                                    </tr>
                                    <tr>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                        <td class="text-nowrap" style="text-align:center;">ส่ง</td>
                                        <td class="text-nowrap" style="text-align:center;">รับ</td>
                                    </tr>
                                    @foreach (var item in Model.stockSearchResultVM.resultList)
                                    {
                                        <tr>
                                            <td class="text-nowrap">@item.ST_PR_CATEGORY_NAME</td>
                                            <td class="text-nowrap">@item.ITEM_CODE</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.S_01</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_01</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_02</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_02</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_03</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_03</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_04</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_04</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_05</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_05</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_06</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_06</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_07</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_07</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_08</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_08</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_09</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_09</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_10</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_10</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.S_11</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_11</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_12</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_12</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_13</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_13</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_14</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_14</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_15</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_15</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_16</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_16</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_17</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_17</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_18</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_18</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_19</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_19</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_20</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_20</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.S_21</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_21</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_22</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_22</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_23</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_23</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_24</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_24</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_25</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_25</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_26</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_26</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_27</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_27</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_28</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_28</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_29</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_29</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_30</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_30</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_31</td>
                                            <td class="text-nowrap" style="text-align:center;">@item.R_31</td>
                                        </tr>
                                    }
                                </table>
                            </div>
                        </div>
                    </div>
                }
            }
        }

    </form>
</div>

<style>
    .text-nowrap {
        white-space: nowrap;
    }
</style>
<script>
    function gotoSearch() {
        var url1 = '@Url.Action("StockTotalSearch")';
        url1 = url1.substring(0, url1.lastIndexOf("StockTotalSearch")).concat("StockTotalSearch");

        var vform = $('#form1');
        vform.attr("action", url1);
        vform.attr("method", "post");
        vform.submit();
    }

    function gotoClear() {
        var url1 = '@Url.Action("StockTotal")';
        url1 = url1.substring(0, url1.lastIndexOf("StockTotal")).concat("StockTotal");

        var vform = $('#form1');
        vform.attr("action", url1);
        vform.attr("method", "post");
        vform.submit();
    }

    function gotoDownloadFile() {
        var url1 = '@Url.Action("StockTotalExport")';
        url1 = url1.substring(0, url1.lastIndexOf("StockTotalExport")).concat("StockTotalExport");

        var vform = $('#form1');
        vform.attr("action", url1);
        vform.attr("method", "post");
        vform.submit();
    }
</script>